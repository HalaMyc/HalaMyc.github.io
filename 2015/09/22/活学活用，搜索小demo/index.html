<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 活学活用，搜索小demo · HalaMyc</title><meta name="description" content="活学活用，搜索小demo - MouYacheng"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/author.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div id="mask" style="display: none;"><img id="mask-image" src="#" style=" "></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/author.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">活学活用，搜索小demo</h1><div class="post-time">Sep 22, 2015</div><div class="post-content"><p>前两天看了<a href="http://www.weibo.com/u/1438670852?from=feed&amp;loc=avatar" target="_blank" rel="external">叶孤城</a>大神的文章，<a href="http://www.jianshu.com/p/d63d0509229c?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=writer_share&amp;utm_source=weibo" target="_blank" rel="external">为什么说,你纯看代码而没有碰到这个场景你就算看懂了也没法理解?</a>，感觉特别有用，所以想试着写一个小的demo，实际操作一下关于搜索的这个技巧，demo在这：<a href="https://github.com/HalaMyc/searchDemo" target="_blank" rel="external">searchDemo</a><br><a id="more"></a><br>demo运行效果图</p>
<p><img src="https://ooo.0o0.ooo/2015/09/22/560130d2ccf3b.gif" alt="Untitled.gif" title="Untitled.gif"></p>
<h4 id="代码核心">代码核心</h4><p>大神的博客中写的很清楚了，我们每次输入都会发送一个请求，而AFN中请求是通过NSOperation进行的，学习过多线程的知识就会知道，多线程返回的结果很难控制，很可能我们输入了www，最终返回的是输入ww时返回的结果，这样的话就不是我们希望的结果了，所以我们必须进行一些处理，关键其实就是将上一个请求给cancel掉，cancel掉之后即使有返回数据，我们可以通过判断这个请求是否已经被cancel来判断是否对数据进行处理。</p>
<h4 id="关于监听输入">关于监听输入</h4><p>博客中写的是通过UITextFiled的代理方法获取每次输入的字符，但是我在UITextField的delegate中并没有发现那个方法可以监听输入（也可能是因为我确实没找到），不过在寻找的过程中我发现了<code>UITextFieldTextDidChangeNotification</code>这个常量，说明可以通过注册通知来监听输入的改变</p>
<h4 id="关于接口">关于接口</h4><p>一开始我在百度的apistore中找到了一个音乐搜索接口，但是在使用中发现返回的一直是null，原因未知，让安卓开发的朋友试了下也是null，所以最终还是决定自己用node.js写一个简单的本地接口调用，返回的数据只是多条跟输入字符相同的数据，仅仅做测试还是够了的。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2015/10/24/Cocoapods正确的使用姿势/" class="prev">PREV</a><a href="/2015/09/19/iOS-导航栏覆盖问题/" class="next">NEXT</a></div><div data-thread-key="2015/09/22/活学活用，搜索小demo/" data-title="活学活用，搜索小demo" data-url="http://www.halamyc.me/2015/09/22/活学活用，搜索小demo/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"HalaMyc"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2016 <a href="http://www.halamyc.me">MouYacheng</a>, unless otherwise noted.</p></div></footer></div><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>